{"version":3,"sources":["index.js"],"names":["DEFAULTS","BASE_TEN","FAILOVER_ERROR_CODES","HTTP_ERROR_CODE_RETRY_THRESHHOLD","HTTP_ERROR_CODE_THRESHHOLD","MAX_REDIRECT_COUNT","MAX_RETRY_COUNT","TIMEOUT","EVENTS","error","redirect","request","response","retry","HTTP_HEADERS","CONNECTION","CONTENT_LENGTH","CONTENT_TYPE","LOCATION","HTTP_STATUS_CODES","NO_CONTENT","PROXY_REQUIRED","REDIRECT_CODE_PERM","REDIRECT_CODE_TEMP","REDIRECT_NEW_CODE_PERM","REDIRECT_NEW_CODE_TEMP","RE_CHARSET","RE_CONTENT_TYPE_JSON","RE_CONTENT_TYPE_TEXT","RE_ENDS_WITH_S","RE_TLS_PROTOCOL","RE_URL_PARAMETERS","SUPPORTED_REQUEST_OPTIONS","coalesce","args","filter","value","isEmpty","ensureOptions","isObject","url","parse","headerExists","headers","name","toLowerCase","length","some","result","toString","test","mergeOptions","options","forEach","option","maxRedirectCount","maxRetryCount","timeout","query","squareBracketNotation","param","join","Date","toISOString","path","qs","stringify","parseUrlPattern","urlPattern","parts","match","parameters","split","parameter","push","regEx","RegExp","buldSerializedQueryParam","document","serializedKey","key","resultQuery","Request","data","callback","executeRequest","self","state","failover","index","values","redirects","tries","Buffer","byteLength","field","slice","concat","map","hostname","portIndex","indexOf","port","substr","host","resolve","reject","clientRequest","emit","client","protocol","https","http","chunks","contentType","json","code","statusCode","err","Error","redirectUrl","previousRequestProtocol","href","context","stream","contentParts","setEncoding","ex","on","chunk","body","JSON","setTimeout","abort","write","end","then","catch","method","call","events","EventEmitter","Resource","urlParts","post","delete","get","put","module","exports"],"mappings":"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","sourcesContent":["import events from 'events';\nimport http from 'http';\nimport https from 'https';\nimport qs from 'querystring';\nimport url from 'url';\n\nconst\n\tDEFAULTS = {\n\t\tBASE_TEN : 10,\n\t\tFAILOVER_ERROR_CODES : [\n\t\t\t'ECONNREFUSED',\n\t\t\t'ECONNRESET',\n\t\t\t'ENOTFOUND'\n\t\t],\n\t\tHTTP_ERROR_CODE_RETRY_THRESHHOLD : 500,\n\t\tHTTP_ERROR_CODE_THRESHHOLD : 400,\n\t\tMAX_REDIRECT_COUNT : 5,\n\t\tMAX_RETRY_COUNT : 3,\n\t\tTIMEOUT : 60000\n\t},\n\tEVENTS = {\n\t\terror : 'error',\n\t\tredirect : 'redirect',\n\t\trequest :'request',\n\t\tresponse : 'response',\n\t\tretry : 'retry'\n\t},\n\tHTTP_HEADERS = {\n\t\tCONNECTION : 'Connection',\n\t\tCONTENT_LENGTH : 'Content-Length',\n\t\tCONTENT_TYPE : 'Content-Type',\n\t\tLOCATION : 'Location'\n\t},\n\t// reference: https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#3xx_Redirection\n\tHTTP_STATUS_CODES = {\n\t\tNO_CONTENT : 204,\n\t\tPROXY_REQUIRED : 305,\n\t\tREDIRECT_CODE_PERM : 301,\n\t\tREDIRECT_CODE_TEMP : 302,\n\t\tREDIRECT_NEW_CODE_PERM : 308,\n\t\tREDIRECT_NEW_CODE_TEMP : 307\n\t},\n\tRE_CHARSET = /\\ charset\\=(a-z\\-0-9)*/i,\n\tRE_CONTENT_TYPE_JSON = /json/i,\n\tRE_CONTENT_TYPE_TEXT = /json|xml|yaml|html|text|jwt/i,\n\tRE_ENDS_WITH_S = /s$/i,\n\tRE_TLS_PROTOCOL = /^https\\:?/i,\n\tRE_URL_PARAMETERS = /(\\/\\:([a-z0-9\\_\\-\\~\\.]*))*/gi,\n\tSUPPORTED_REQUEST_OPTIONS = [\n\t\t'agent',\n\t\t'auth',\n\t\t'family',\n\t\t'headers',\n\t\t'host',\n\t\t'hostname',\n\t\t'hosts', // custom\n\t\t'hostnames', // custom\n\t\t// 'keepAlive', // custom\n\t\t// 'keepAliveMsecs', // custom\n\t\t'localAddress',\n\t\t'maxRedirectCount', // custom\n\t\t'maxRetryCount', // custom\n\t\t'method',\n\t\t'path',\n\t\t'pathname',\n\t\t'port',\n\t\t'protocol', // use to determine HTTPS or HTTP\n\t\t'query', // custom\n\t\t'rejectUnauthorized',\n\t\t'socketPath',\n\t\t'timeout'\n\t];\n\nfunction coalesce (...args) {\n\treturn args.filter((value) => !isEmpty(value))[0];\n}\n\nfunction ensureOptions (value) {\n\tif (!isObject(value) && typeof value === 'string') {\n\t\treturn url.parse(value);\n\t}\n\n\treturn value;\n}\n\nfunction headerExists (headers, name) {\n\treturn !isEmpty(headers[name]) || !isEmpty(headers[name.toLowerCase()]);\n}\n\nfunction isEmpty (value) {\n\treturn (value === null || [\n\t\ttypeof value === 'undefined',\n\t\ttypeof value === 'string' && !value.length,\n\t\tArray.isArray(value) && !value.length,\n\t\tisObject(value) && !Object.keys(value).length\n\t].some((result) => result));\n}\n\nfunction isObject (value) {\n\treturn ![\n\t\tvalue === null,\n\t\ttypeof value === 'undefined',\n\t\ttypeof value !== 'object',\n\t\tArray.isArray(value),\n\t\tvalue && value.toString && !(/^\\[object\\sObject\\]$/.test(value.toString()))\n\t].some((result) => result);\n}\n\nfunction mergeOptions (request, options = {}) {\n\tlet result = {};\n\n\t// ensure request options exist\n\trequest = request || {};\n\trequest.options = request.options || {};\n\n\tSUPPORTED_REQUEST_OPTIONS.forEach((option) => {\n\t\tlet value = coalesce(options[option], request.options[option]);\n\n\t\tif (!isEmpty(value)) {\n\t\t\tresult[option] = value;\n\t\t}\n\t});\n\n\t// TODO: apply keep-alive\n\n\t// apply redirect\n\tresult.maxRedirectCount = coalesce(\n\t\tresult.maxRedirectCount,\n\t\tDEFAULTS.MAX_REDIRECT_COUNT);\n\n\t// apply retry\n\tresult.maxRetryCount = coalesce(\n\t\tresult.maxRetryCount,\n\t\tDEFAULTS.MAX_RETRY_COUNT);\n\n\t// apply timeout\n\tresult.timeout = coalesce(\n\t\tresult.timeout,\n\t\tDEFAULTS.TIMEOUT);\n\n\t// validate the query\n\tif (!isEmpty(result.query)) {\n\t\t// format objects using square-bracket notation\n\t\tresult.query = squareBracketNotation(result.query);\n\n\t\t// serialization adjustments for querystring\n\t\tObject.keys(result.query).forEach((param) => {\n\t\t\t// ensure arrays in querystring are properly serialized...\n\t\t\tif (Array.isArray(result.query[param]) && result.query[param].length > 1) {\n\t\t\t\tresult.query[param] = result.query[param].join(',');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// turn date objects into ISO strings\n\t\t\tif (result.query[param] instanceof Date) {\n\t\t\t\tresult.query[param] = result.query[param].toISOString();\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\n\t\t// ensure the path is properly set\n\t\tresult.path = [\n\t\t\tresult.path,\n\t\t\tqs.stringify(result.query)].join('?');\n\t}\n\n\treturn result;\n}\n\nfunction parseUrlPattern (urlPattern) {\n\tlet parts = url.parse(urlPattern);\n\n\t// determine parameters within the URL (if applicable)\n\tparts.path\n\t\t.match(RE_URL_PARAMETERS)\n\t\t// .filter((match) => RE_URL_PARAMETERS.test(match))\n\t\t.forEach((match) => {\n\t\t\tlet parameters = match.split(RE_URL_PARAMETERS);\n\t\t\tif (!parameters.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// ensure parameters exist on the response\n\t\t\tparts.parameters = parts.parameters || [];\n\n\t\t\t// iterate each match\n\t\t\tparameters\n\t\t\t\t.filter((parameter) => !isEmpty(parameter))\n\t\t\t\t.forEach((parameter) => {\n\t\t\t\t\t// isolate the parameters from the URL\n\t\t\t\t\tif (!/^\\//.test(parameter)) {\n\t\t\t\t\t\tparts.parameters.push({\n\t\t\t\t\t\t\tname : parameter,\n\t\t\t\t\t\t\tregEx : new RegExp(`\\:${parameter}`)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\n\treturn parts;\n}\n\nfunction squareBracketNotation (query) {\n\tif (isEmpty(query)) {\n\t\treturn query;\n\t}\n\n\tlet\n\t\tbuldSerializedQueryParam = (document, serializedKey = '') => Object\n\t\t\t.keys(document)\n\t\t\t.forEach((key) => {\n\t\t\t\tif (isEmpty(document[key])) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!isObject(document[key])) {\n\t\t\t\t\tresultQuery[serializedKey ? `${serializedKey}[${key}]` : key] = document[key];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn buldSerializedQueryParam(\n\t\t\t\t\tdocument[key],\n\t\t\t\t\tserializedKey ? `${serializedKey}[${key}]` : key);\n\t\t\t}),\n\t\tresultQuery = {};\n\n\t// kick off the serialization\n\tbuldSerializedQueryParam(query);\n\n\treturn resultQuery;\n}\n\nclass Request extends events.EventEmitter {\n\tconstructor (options) {\n\t\tsuper();\n\t\tthis.options = options;\n\t}\n\n\tcall (options, data, callback) {\n\t\tlet\n\t\t\texecuteRequest,\n\t\t\tself = this,\n\t\t\tstate = {};\n\n\t\tif (typeof data === 'function') {\n\t\t\tcallback = data;\n\t\t\tdata = '';\n\t\t}\n\n\t\tif (typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\tdata = '';\n\t\t\toptions = {};\n\t\t}\n\n\t\t// ensure default values for state\n\t\tstate.data = data || '';\n\t\tstate.failover = {\n\t\t\tindex : 0,\n\t\t\tvalues : []\n\t\t};\n\t\tstate.redirects = state.redirects || [];\n\t\tstate.tries = state.tries || 1;\n\n\t\t// ensure default values for all request options\n\t\toptions = mergeOptions(this, options);\n\t\toptions.headers = options.headers || {};\n\n\t\t// check to see if content-type is specified\n\t\tif (!headerExists(options.headers, HTTP_HEADERS.CONTENT_TYPE)) {\n\t\t\t// apply application/json header as default (this is opinionated)\n\t\t\toptions.headers[HTTP_HEADERS.CONTENT_TYPE] = 'application/json';\n\n\t\t\t// serialize data (if provided) as JSON\n\t\t\tif (isObject(state.data)) {\n\t\t\t\tstate.data = JSON.stringify(state.data);\n\t\t\t}\n\t\t}\n\n\t\t// ensure state data is\n\t\tif (isObject(state.data) && state.data.toString) {\n\t\t\tstate.data = state.data.toString();\n\t\t}\n\n\t\t// apply content length header\n\t\toptions.headers[HTTP_HEADERS.CONTENT_LENGTH] =\n\t\t\toptions.headers[HTTP_HEADERS.CONTENT_LENGTH] ||\n\t\t\tBuffer.byteLength(state.data);\n\n\t\t// setup failover if applicable\n\t\t['host', 'hostname', 'hostnames', 'hosts'].forEach((field) => {\n\t\t\tlet key = RE_ENDS_WITH_S.test(field) ?\n\t\t\t\tfield.slice(0, -1) :\n\t\t\t\tfield;\n\n\t\t\t// if the host or hostname field value is an Array\n\t\t\t// map the values into the state.failover\n\t\t\tif (Array.isArray(options[field])) {\n\t\t\t\tstate.failover.values = state.failover.values\n\t\t\t\t\t.concat(options[field].map((value) => ({ key, value })));\n\n\t\t\t\t// clear the failover settings from the options as it will be overridden\n\t\t\t\tdelete options[field];\n\t\t\t}\n\t\t});\n\n\t\t// set the current default host/hostname if failover options are present\n\t\tif (state.failover.values.length) {\n\t\t\toptions[state.failover.values[state.failover.index].key] =\n\t\t\t\tstate.failover.values[state.failover.index].value;\n\t\t}\n\n\t\t// correct for port in the hostname field...\n\t\tif (!isEmpty(options.hostname)) {\n\t\t\tlet portIndex = options.hostname.indexOf(':');\n\n\t\t\tif (portIndex > 0) {\n\t\t\t\t// set port, host and hostname correctly\n\t\t\t\toptions.port = parseInt(\n\t\t\t\t\tcoalesce(options.port, options.hostname.substr(portIndex + 1)),\n\t\t\t\t\tDEFAULTS.BASE_TEN);\n\n\t\t\t\toptions.host = options.hostname;\n\t\t\t\toptions.hostname = options.hostname.substr(0, portIndex);\n\t\t\t}\n\t\t}\n\n\t\t// apply keep-alive header when specified\n\t\t/*\n\t\tif (options.keepAlive && !headerExists(options.headers, HTTP_HEADERS.CONNECTION)) {\n\t\t\toptions.headers[HTTP_HEADERS.CONNECTION] = 'keep-alive';\n\t\t}\n\t\t//*/\n\n\t\texecuteRequest = new Promise((resolve, reject) => {\n\t\t\tlet clientRequest = () => {\n\t\t\t\t// emit request event\n\t\t\t\tself.emit(EVENTS.request, {\n\t\t\t\t\toptions,\n\t\t\t\t\tstate\n\t\t\t\t});\n\n\t\t\t\tlet client = (RE_TLS_PROTOCOL.test(options.protocol) ? https : http).request(\n\t\t\t\t\toptions,\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tlet\n\t\t\t\t\t\t\tchunks = [],\n\t\t\t\t\t\t\tcontentType = coalesce(\n\t\t\t\t\t\t\t\tresponse.headers[HTTP_HEADERS.CONTENT_TYPE],\n\t\t\t\t\t\t\t\tresponse.headers[HTTP_HEADERS.CONTENT_TYPE.toLowerCase()]),\n\t\t\t\t\t\t\tjson = RE_CONTENT_TYPE_JSON.test(contentType),\n\t\t\t\t\t\t\tredirect = [\n\t\t\t\t\t\t\t\tHTTP_STATUS_CODES.REDIRECT_CODE_PERM,\n\t\t\t\t\t\t\t\tHTTP_STATUS_CODES.REDIRECT_CODE_TEMP,\n\t\t\t\t\t\t\t\tHTTP_STATUS_CODES.REDIRECT_NEW_CODE_PERM,\n\t\t\t\t\t\t\t\tHTTP_STATUS_CODES.REDIRECT_NEW_CODE_TEMP\n\t\t\t\t\t\t\t].some((code) => (code === response.statusCode));\n\n\t\t\t\t\t\t// track response headers and status\n\t\t\t\t\t\tstate.headers = response.headers;\n\t\t\t\t\t\tstate.statusCode = response.statusCode;\n\n\t\t\t\t\t\t// emit response event\n\t\t\t\t\t\tself.emit(EVENTS.response, {\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tstate\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// determine if a proxy server is required...\n\t\t\t\t\t\tif (state.statusCode === HTTP_STATUS_CODES.PROXY_REQUIRED) {\n\t\t\t\t\t\t\tlet err = new Error('proxy required');\n\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\terr.state = state;\n\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// determine if a redirect has been detected\n\t\t\t\t\t\tif (redirect) {\n\t\t\t\t\t\t\tif (!headerExists(state.headers, HTTP_HEADERS.LOCATION)) {\n\t\t\t\t\t\t\t\tlet err = new Error('redirect requested with no location');\n\t\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\t\terr.state = state;\n\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (state.redirects.length >= options.maxRedirectCount) {\n\t\t\t\t\t\t\t\tlet err = new Error('maximum redirect limit exceeded');\n\t\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\t\terr.state = state;\n\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// read location from headers\n\t\t\t\t\t\t\tlet redirectUrl = url.parse(coalesce(\n\t\t\t\t\t\t\t\tresponse.headers[HTTP_HEADERS.LOCATION],\n\t\t\t\t\t\t\t\tresponse.headers[HTTP_HEADERS.LOCATION.toLowerCase()]));\n\n\t\t\t\t\t\t\t// set protocol when missing (i.e. location begins with '//' instead of protocol)\n\t\t\t\t\t\t\tif (isEmpty(redirectUrl.protocol)) {\n\t\t\t\t\t\t\t\tlet previousRequestProtocol = state.redirects.length ?\n\t\t\t\t\t\t\t\t\tstate.redirects[state.redirects.length - 1].protocol :\n\t\t\t\t\t\t\t\t\toptions.protocol;\n\n\t\t\t\t\t\t\t\tredirectUrl = url.parse([previousRequestProtocol, redirectUrl.href].join(''));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// remap options for next request\n\t\t\t\t\t\t\tObject.assign(options, redirectUrl);\n\n\t\t\t\t\t\t\t// increment number of redirects (to avoid endless looping)\n\t\t\t\t\t\t\tstate.redirects.push(redirectUrl);\n\n\t\t\t\t\t\t\t// emit redirect event\n\t\t\t\t\t\t\tself.emit(EVENTS.redirect, {\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\tstate\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// re-request based on the redirect location\n\t\t\t\t\t\t\treturn setImmediate(clientRequest);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// utilize content-type to understand if response should be a stream\n\t\t\t\t\t\t// assume missing content-type header indicates text value\n\t\t\t\t\t\tif (contentType && !RE_CONTENT_TYPE_TEXT.test(contentType)) {\n\t\t\t\t\t\t\tif (context.statusCode >= DEFAULTS.HTTP_ERROR_CODE_THRESHHOLD) {\n\t\t\t\t\t\t\t\tlet err = new Error('HTTP error received for streaming Content-Type');\n\t\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\t\terr.state = state;\n\t\t\t\t\t\t\t\terr.stream = response;\n\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn resolve(response);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// handle the response encoding...\n\t\t\t\t\t\tif (!isEmpty(contentType)) {\n\t\t\t\t\t\t\tlet contentParts = contentType.split(RE_CHARSET);\n\n\t\t\t\t\t\t\t// if a charset was specified, apply it\n\t\t\t\t\t\t\tif (contentParts.length > 1) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tresponse.setEncoding(contentParts[contentParts.length - 1]);\n\t\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\t\t// TODO: handle warning...\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresponse.on('data', (chunk) => chunks.push(chunk));\n\n\t\t\t\t\t\tresponse.on('end', () => {\n\t\t\t\t\t\t\tlet\n\t\t\t\t\t\t\t\tbody = chunks.join(''),\n\t\t\t\t\t\t\t\terror = state.statusCode >= DEFAULTS.HTTP_ERROR_CODE_THRESHHOLD,\n\t\t\t\t\t\t\t\tretry =\n\t\t\t\t\t\t\t\t\tstate.statusCode >= DEFAULTS.HTTP_ERROR_CODE_RETRY_THRESHHOLD &&\n\t\t\t\t\t\t\t\t\tstate.tries <= options.maxRetryCount,\n\t\t\t\t\t\t\t\tstatusCode = response.statusCode;\n\n\t\t\t\t\t\t\tif (json && statusCode !== HTTP_STATUS_CODES.NO_CONTENT && body.length) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tbody = JSON.parse(body);\n\t\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\t\tlet err = new Error('unable to parse JSON from response');\n\t\t\t\t\t\t\t\t\terr.body = body;\n\t\t\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\t\t\terr.state = state;\n\n\t\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// retry request when an error above the threshhold is received\n\t\t\t\t\t\t\tif (retry) {\n\t\t\t\t\t\t\t\t// emit retry event\n\t\t\t\t\t\t\t\tself.emit(EVENTS.retry, {\n\t\t\t\t\t\t\t\t\tbody,\n\t\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\t\tstate\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// increment try count\n\t\t\t\t\t\t\t\tstate.tries += 1;\n\n\t\t\t\t\t\t\t\treturn clientRequest();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\tlet err = new Error('HTTP error received');\n\t\t\t\t\t\t\t\terr.body = body;\n\t\t\t\t\t\t\t\terr.options = options;\n\t\t\t\t\t\t\t\terr.state = state;\n\t\t\t\t\t\t\t\terr.statusCode = statusCode;\n\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn resolve(body);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\tclient.on(EVENTS.error, (err) => {\n\t\t\t\t\tlet failover = (\n\t\t\t\t\t\tstate.failover.values.length &&\n\t\t\t\t\t\terr.code &&\n\t\t\t\t\t\tDEFAULTS.FAILOVER_ERROR_CODES.indexOf(err.code) !== -1);\n\n\t\t\t\t\t// check for failover\n\t\t\t\t\tif (failover) {\n\t\t\t\t\t\tstate.tries += 1;\n\t\t\t\t\t\tstate.failover.index = (\n\t\t\t\t\t\t\tstate.failover.index === state.failover.values.length - 1 ?\n\t\t\t\t\t\t\t\t0 :\n\t\t\t\t\t\t\t\tstate.failover.index + 1);\n\n\t\t\t\t\t\tif (state.tries <= state.failover.values.length) {\n\t\t\t\t\t\t\t// remove host and hostname from options to prevent conflict with prior request\n\t\t\t\t\t\t\tdelete options.hostname;\n\t\t\t\t\t\t\tdelete options.host;\n\n\t\t\t\t\t\t\toptions[state.failover.values[state.failover.index].key] =\n\t\t\t\t\t\t\t\tstate.failover.values[state.failover.index].value;\n\n\t\t\t\t\t\t\treturn setImmediate(clientRequest);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// retry if below retry count threshhold\n\t\t\t\t\tif (state.tries <= options.maxRetryCount) {\n\t\t\t\t\t\tstate.tries += 1;\n\t\t\t\t\t\treturn setImmediate(clientRequest);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn reject(err);\n\t\t\t\t});\n\n\t\t\t\t// apply request timeout\n\t\t\t\tif (options.timeout) {\n\t\t\t\t\t// convert timeout to a number if provided as a string\n\t\t\t\t\tif (typeof options.timeout === 'string') {\n\t\t\t\t\t\toptions.timeout = parseInt(options.timeout, DEFAULTS.BASE_TEN);\n\t\t\t\t\t}\n\n\t\t\t\t\tclient.setTimeout(options.timeout, client.abort);\n\t\t\t\t}\n\n\t\t\t\t// send data\n\t\t\t\tif (state.data) {\n\t\t\t\t\tclient.write(state.data);\n\t\t\t\t}\n\n\t\t\t\t// finish up the client stream and end to send\n\t\t\t\tclient.end();\n\t\t\t};\n\n\t\t\tclientRequest();\n\t\t});\n\n\t\t// return Promise for async/await or then/catch\n\t\tif (isEmpty(callback)) {\n\t\t\treturn executeRequest;\n\t\t}\n\n\t\t// execute and return results in callback\n\t\treturn executeRequest\n\t\t\t.then((result) => callback(null, result))\n\t\t\t.catch(callback);\n\t}\n\n\tgetOptions (options = {}) {\n\t\treturn mergeOptions(this, options);\n\t}\n\n\t// delete\n\tasync delete (options = {}, callback) {\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'DELETE';\n\t\treturn await this.call(options, callback);\n\t}\n\n\t// get\n\tasync get (options = {}, callback) {\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'GET';\n\t\treturn await this.call(options, callback);\n\t}\n\n\t// head\n\tasync head (options = {}, callback) {\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'HEAD';\n\t\treturn await this.call(options, callback);\n\t}\n\n\t// patch\n\tasync patch (options = {}, data, callback) {\n\t\tif (typeof data === 'function' && isEmpty(callback)) {\n\t\t\tcallback = data;\n\t\t\tdata = null;\n\t\t}\n\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'PATCH';\n\t\treturn await this.call(options, data, callback);\n\t}\n\n\t// post\n\tasync post (options = {}, data, callback) {\n\t\tif (typeof data === 'function' && isEmpty(callback)) {\n\t\t\tcallback = data;\n\t\t\tdata = null;\n\t\t}\n\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'POST';\n\t\treturn await this.call(options, data, callback);\n\t}\n\n\t// put\n\tasync put (options = {}, data, callback) {\n\t\tif (typeof data === 'function' && isEmpty(callback)) {\n\t\t\tcallback = data;\n\t\t\tdata = null;\n\t\t}\n\n\t\tif (typeof options === 'function' && isEmpty(callback)) {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions = ensureOptions(options);\n\t\toptions.method = 'PUT';\n\t\treturn await this.call(options, data, callback);\n\t}\n}\n\nclass Resource {\n\tconstructor (urlPattern, options) {\n\t\tif (isEmpty(urlPattern)) {\n\t\t\tthrow new Error('urlPattern argument is required');\n\t\t}\n\n\t\tthis.request = new Request(options);\n\t\tthis.urlParts = parseUrlPattern(urlPattern);\n\t}\n\n\tasync create (data, callback) {\n\t\tlet options = this.urlParts;\n\n\t\treturn await this.request.post(options, data, callback);\n\t}\n\n\tasync delete (...args) {\n\t\tlet\n\t\t\tcallback = args && typeof args[args.length - 1] === 'function' ?\n\t\t\t\targs[args.length - 1] :\n\t\t\t\tcallback,\n\t\t\toptions = this.urlParts;\n\n\t\t// TODO: map values based on urlParts.parameters\n\t\toptions.query = args;\n\n\t\treturn await this.request.delete(options, callback);\n\t}\n\n\tasync retrieve (...args) {\n\t\tlet\n\t\t\tcallback = args && typeof args[args.length - 1] === 'function' ?\n\t\t\t\targs[args.length - 1] :\n\t\t\t\tcallback,\n\t\t\toptions = this.urlParts;\n\n\t\t// TODO: map values based on urlParts.parameters\n\t\toptions.query = args;\n\n\t\treturn await this.request.get(options, callback);\n\t}\n\n\tasync update (data, callback) {\n\t\tlet options = this.urlParts;\n\n\t\treturn await this.request.put(options, data, callback);\n\t}\n}\n\nmodule.exports = { Request, Resource };"],"file":"index.js"}